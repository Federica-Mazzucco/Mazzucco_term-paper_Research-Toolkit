---
title: "'Behave': cleaning and analysis"
author: "Federica Mazzucco"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(psych)
library(ggplot2)
library(rmarkdown)
library(tidyverse)
library(esquisse)
library(data.table)
library(forcats)
```



```{r, include=FALSE}
behave <- fread('https://raw.github.tik.uni-stuttgart.de/ac140358/ERT4HSoSe2022/main/behave.csv?token=AAABK5CQSO65UMAUJS67NFTDB5R5S')
```




## Tidying up the "behave" data file

### Select columns and check for missing data
Select only relevant columns:
```{r}
behave <- select(behave, ID, Verb, Age, Adjective, Gender, Handedness, Item, Condition, Rating)
```


Check if there are missing data:
```{r}
colSums(is.na(behave))
```
There are no missing data.




### Check for off-scale values

Select unique values:

```{r}
unique(select(behave, Verb), incomparables = FALSE)
```

The verb *sein*, "to be", is spelt wrong in the first line. Let's fix it:

```{r}
sein <- c("seein", "sein")
```

```{r}
behave <- behave %>% mutate(Verb = fct_collapse(Verb, sein = sein))
```


Let's check the age of the participants:
```{r}
unique(select(behave, Age), incomparables = FALSE)
```

A participant cannot be aged 230, so we need to remove them from the database: 
```{r}
behave <- filter(behave, Age <= 30)
```


To have more information on the participants, we can also check their gender:
```{r}
count(behave, Gender)
```







A 1-7 Likert scale was used. Some ratings are clearly off:
```{r}
unique(select(behave, Rating), incomparables = FALSE)
```



```{r}
count(behave, Rating)
```


I need to get rid of those off-scale ratings

```{r}
behave <- filter(behave, Rating != 0, Rating != 10, Rating != 11)
```






### Clean the dataset from irrelevant Conditions and Items
The "stimuli" file only contains 30 stimuli divided into Conditions 1, 2, 3, 4. Condition 100 contains 100 further stimuli. It is irrelevant, meant only to distract the participants from the real purpose of the experiment.
We can get rid of it.

```{r}
behave <- filter(behave, Condition <= 4)
```



## Analysing the dataset

### Summary statistics

produce summary statistics (mean, standard variation, minimum, maximum). The descriptive statistics should relate to the experiment design, i.e. the verb and adjective types. Make at least one plot that is appropriate for your data.

We can create a summary to better visualize our data:
```{r}
behave_summary <- behave %>%
 group_by(Condition, Rating) %>%
 summarise(Count = n()) %>%
 mutate(Frequency = 100*Count / sum(Count))
```
```{r}
print(behave_summary)
```



mean rating for each condition:
```{r}
mean(filter(behave, Condition == 1)$Rating)
mean(filter(behave, Condition == 2)$Rating)
mean(filter(behave, Condition == 3)$Rating)
mean(filter(behave, Condition == 4)$Rating)
```



Standard variation
```{r}
sd(filter(behave, Condition == 1)$Rating)
sd(filter(behave, Condition == 2)$Rating)
sd(filter(behave, Condition == 3)$Rating)
sd(filter(behave, Condition == 4)$Rating)
```


Minimum
```{r}
min(filter(behave, Condition == 1)$Rating)
min(filter(behave, Condition == 2)$Rating)
min(filter(behave, Condition == 3)$Rating)
min(filter(behave, Condition == 4)$Rating)
```

Maximum
```{r}
max(filter(behave, Condition == 1)$Rating)
max(filter(behave, Condition == 2)$Rating)
max(filter(behave, Condition == 3)$Rating)
max(filter(behave, Condition == 4)$Rating)
```

It is now possible to create a single data frame which contains all the summary statistics:

```{r}
Condition <- c("1", "2", "3", "4")
Mean_rating <- c(5.013652, 4.804196, 4.969072, 2.986254)
Standard_variation <- c(1.282049, 1.705548, 1.463017, 1.073096)
Minimum <- c(1, 1, 1, 1)
Maximum <- c(7, 7, 7, 6)

behave_statistics <- data.frame(Condition, Mean_rating, Standard_variation, Minimum, Maximum)

print(behave_statistics)
```


Easier visualization trough a plot:


```{r}
ggplot(behave_statistics,aes(x=Condition))+
  geom_boxplot(aes(lower=Mean_rating- Standard_variation, upper= Mean_rating + Standard_variation, middle= Mean_rating, ymin= Minimum,ymax= Maximum),stat="identity")+
  labs(x = "Conditions", y= "Mean ratings", title = "Overview of results", subtitle = "Mean rating and standard deviation for each condition")
```

### R Session

R version 4.1.3 (2022-03-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default

locale:
[1] LC_COLLATE=Italian_Italy.1252 
[2] LC_CTYPE=Italian_Italy.1252   
[3] LC_MONETARY=Italian_Italy.1252
[4] LC_NUMERIC=C                  
[5] LC_TIME=Italian_Italy.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets 
[6] methods   base     

other attached packages:
 [1] data.table_1.14.2 esquisse_1.1.1   
 [3] forcats_0.5.1     stringr_1.4.0    
 [5] dplyr_1.0.8       purrr_0.3.4      
 [7] readr_2.1.2       tidyr_1.2.0      
 [9] tibble_3.1.6      tidyverse_1.3.1  
[11] rmarkdown_2.13    ggplot2_3.3.5    
[13] psych_2.2.3      

loaded via a namespace (and not attached):
 [1] httr_1.4.2          sass_0.4.1         
 [3] jsonlite_1.8.0      tmvnsim_1.0-2      
 [5] modelr_0.1.8        bslib_0.3.1        
 [7] shiny_1.7.1         assertthat_0.2.1   
 [9] cellranger_1.1.0    yaml_2.3.5         
[11] pillar_1.7.0        backports_1.4.1    
[13] lattice_0.20-45     glue_1.6.2         
[15] digest_0.6.29       promises_1.2.0.1   
[17] rvest_1.0.2         colorspace_2.0-3   
[19] htmltools_0.5.2     httpuv_1.6.5       
[21] pkgconfig_2.0.3     broom_0.8.0        
[23] haven_2.5.0         xtable_1.8-4       
[25] scales_1.2.0        phosphoricons_0.1.2
[27] openxlsx_4.2.5      later_1.3.0        
[29] rio_0.5.29          tzdb_0.3.0         
[31] farver_2.1.0        generics_0.1.2     
[33] ellipsis_0.3.2      withr_2.5.0        
[35] datamods_1.3.2      cli_3.2.0          
[37] mnormt_2.0.2        magrittr_2.0.3     
[39] crayon_1.5.1        readxl_1.4.0       
[41] mime_0.12           evaluate_0.15      
[43] fs_1.5.2            fansi_1.0.3        
[45] nlme_3.1-155        xml2_1.3.3         
[47] foreign_0.8-82      tools_4.1.3        
[49] hms_1.1.1           lifecycle_1.0.1    
[51] munsell_0.5.0       reprex_2.0.1       
[53] zip_2.2.0           compiler_4.1.3     
[55] jquerylib_0.1.4     rlang_1.0.2        
[57] grid_4.1.3          rstudioapi_0.13    
[59] labeling_0.4.2      shinyWidgets_0.7.0 
[61] gtable_0.3.0        DBI_1.1.2          
[63] curl_4.3.2          R6_2.5.1           
[65] lubridate_1.8.0     knitr_1.38         
[67] fastmap_1.1.0       utf8_1.2.2         
[69] stringi_1.7.6       parallel_4.1.3     
[71] Rcpp_1.0.8.3        vctrs_0.4.1        
[73] dbplyr_2.1.1        tidyselect_1.1.2   
[75] xfun_0.30          
